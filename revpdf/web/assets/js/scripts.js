window.log=function(){if(log.history=log.history||[],log.history.push(arguments),this.console){var a,b=arguments;b.callee=b.callee.caller,a=[].slice.call(b),"object"==typeof console.log?log.apply.call(console.log,console,a):console.log.apply(console,a)}},function(a){function b(){}for(var c,d="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(",");c=d.pop();)a[c]=a[c]||b}(function(){try{return console.log(),window.console}catch(a){return window.console={}}}()),$.extend($.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper form-inline"}),$.fn.dataTableExt.oApi.fnPagingInfo=function(a){return{iStart:a._iDisplayStart,iEnd:a.fnDisplayEnd(),iLength:a._iDisplayLength,iTotal:a.fnRecordsTotal(),iFilteredTotal:a.fnRecordsDisplay(),iPage:Math.ceil(a._iDisplayStart/a._iDisplayLength),iTotalPages:Math.ceil(a.fnRecordsDisplay()/a._iDisplayLength)}},$.extend($.fn.dataTableExt.oPagination,{bootstrap:{fnInit:function(a,b,c){var d=a.oLanguage.oPaginate,e=function(b){b.preventDefault(),a.oApi._fnPageChange(a,b.data.action)&&c(a)};$(b).addClass("pagination").append('<ul><li class="prev disabled"><a href="#">&larr; '+d.sPrevious+'</a></li><li class="next disabled"><a href="#">'+d.sNext+" &rarr; </a></li></ul>");var f=$("a",b);$(f[0]).bind("click.DT",{action:"previous"},e),$(f[1]).bind("click.DT",{action:"next"},e)},fnUpdate:function(a,b){var c,d,e,f,g,h=5,i=a.oInstance.fnPagingInfo(),j=a.aanFeatures.p,k=Math.floor(h/2);for(i.iTotalPages<h?(f=1,g=i.iTotalPages):i.iPage<=k?(f=1,g=h):i.iPage>=i.iTotalPages-k?(f=i.iTotalPages-h+1,g=i.iTotalPages):(f=i.iPage-k+1,g=f+h-1),c=0,iLen=j.length;iLen>c;c++){for($("li:gt(0)",j[c]).filter(":not(:last)").remove(),d=f;g>=d;d++)e=d==i.iPage+1?'class="active"':"",$("<li "+e+'><a href="#">'+d+"</a></li>").insertBefore($("li:last",j[c])[0]).bind("click",function(c){c.preventDefault(),a._iDisplayStart=(parseInt($("a",this).text(),10)-1)*i.iLength,b(a)});0===i.iPage?$("li:first",j[c]).addClass("disabled"):$("li:first",j[c]).removeClass("disabled"),i.iPage===i.iTotalPages-1||0===i.iTotalPages?$("li:last",j[c]).addClass("disabled"):$("li:last",j[c]).removeClass("disabled")}}}});var myElementMethods={getPositionX:function(){var a=this.css("left"),b=new RegExp("px","g");return null===a&&(a="0px"),parseInt(a.replace(b,""),10)},getPositionY:function(){var a=this.css("top"),b=new RegExp("px","g");return null===a&&(a="0px"),parseInt(a.replace(b,""),10)},setElementHeight:function(a){var b=this.getElementBorder(),c=parseInt(a-b[0].valueOf()-b[2].valueOf(),10);c>this.parent().height()&&(c=parseInt(this.parent().height()-b[0].valueOf()-b[2].valueOf(),10)),this.css("height",parseInt(c,10)+"px")},getElementHeight:function(){return parseInt(this.height(),10)},setElementWidth:function(a,b){var c=this.getElementBorder(),d=parseInt(a-c[1].valueOf()-c[3].valueOf(),10);d>b&&(d=parseInt(b-c[1].valueOf()-c[3].valueOf(),10)),this.css("width",parseInt(d,10)+"px")},getElementWidth:function(){return parseInt(this.width(),10)},setPositionX:function(a){this.css("left",parseInt(a,10)+"px")},setPositionY:function(a){this.css("top",parseInt(a,10)+"px")},setFillColor:function(a){"#"!==a.charAt(0)&&(a="#"+a);try{this.css("background",a)}catch(b){this.css("background","#FFFFFF")}},setBorder:function(a,b){var c=a.toLowerCase(),d="#000000",e="solid";b=Math.ceil(72*b/25.4),$(this).css("border","0px"),c.indexOf("l")>=0&&$(this).css("borderLeft",b+"px "+d+" "+e),c.indexOf("b")>=0&&$(this).css("borderBottom",b+"px "+d+" "+e),c.indexOf("r")>=0&&$(this).css("borderRight",b+"px "+d+" "+e),c.indexOf("t")>=0&&$(this).css("borderTop",b+"px "+d+" "+e)},getElementBorder:function(){var a=parseInt(this.css("borderTopWidth"),10),b=parseInt(this.css("borderRightWidth"),10),c=parseInt(this.css("borderBottomWidth"),10),d=parseInt(this.css("borderLeftWidth"),10);(null===a||""===a)&&(a="0px"),(null===b||""===b)&&(b="0px"),(null===c||""===c)&&(c="0px"),(null===d||""===d)&&(d="0px");for(var e=new Array(a,b,c,d),f=0;f<e.length;f++)e[f]=isNaN(e[f])?0:Math.ceil(e[f]);return e},setTextColor:function(a){"#"!==a.charAt(0)&&(a="#"+a);try{this.css("color",a)}catch(b){this.css("color","#000000")}},setFontStyle:function(a){"undefined"!=typeof a&&(this.css("fontStyle","normal"),this.css("fontWeight","normal"),a.indexOf("U")>=0&&this.css("textDecoration","underline"),a.indexOf("B")>=0&&this.css("fontWeight","bold"),a.indexOf("I")>=0&&this.css("fontStyle","italic"))},setBold:function(a){""===a?this.css("fontWeight","normal"):this.css("fontWeight","bold")},setAlignment:function(a){"L"==a?this.css("textAlign","left"):"R"==a?this.css("textAlign","right"):this.css("textAlign","center")},setZIndex:function(a){this.css("zIndex",a)},setFontSize:function(a){this.css("fontSize",a+"pt")},setFontFamily:function(a){this.css("fontFamily",a)},setField:function(a){var b=this.attr("src");"undefined"==typeof b&&this.html(a)},replaceOptionsBy:function(a,b,c){for(;a.hasChildNodes();)a.removeChild(a.firstChild);b.each(function(b){newOption=document.createElement("option"),newOption.appendChild(document.createTextNode(b.text)),newOption.value=b.value,a.appendChild(newOption),b.value==c&&(a.selectedIndex=a.index)})}};jQuery.fn.extend(myElementMethods),function(a){a.widget("revpdf.border",{options:{noneBorderButton:"BtnBorderNone",allBorderButton:"BtnBorderAll",bottomBorderButton:"BtnBorderBottom",topBorderButton:"BtnBorderTop",leftBorderButton:"BtnBorderLeft",rightBorderButton:"BtnBorderRight",borderWidthElement:"Element_border_width",targetClass:".elementSelected"},borderProperties:["borderBottom","borderTop","borderRight","borderLeft"],commonValue:"#000000 solid",_create:function(){this.list=this.element.delegate("button.btn","click",a.proxy(this._itemClick,this)).delegate("select","change",a.proxy(this._itemChangeWidth,this)),this.refresh()},_itemChangeWidth:function(){var b=this._getWidthInPx(),c=this._getWidth(),d=[],e=this.borderProperties,f=this.commonValue,g=this;a.each([this.options.bottomBorderButton,this.options.topBorderButton,this.options.leftBorderButton,this.options.rightBorderButton],function(b,c){a("#"+c).hasClass("active")&&d.push(e[b])}),a.each(d,function(a,c){g._setProperty(c,b+f)}),g._setElementValue(c)},_setElementValue:function(b){a(this.options.targetClass).each(function(){a(this).trigger("setBorderWidth",[b])})},_itemClick:function(b){var c=this._getWidthInPx(),d=""===a(b.target).prop("id")?a(b.target).parent():a(b.target);switch(d.prop("id")){case this.options.noneBorderButton:property="border",activeValue="0px "+this.commonValue,notActiveValue="0px "+this.commonValue;break;case this.options.allBorderButton:property="border",activeValue=c+this.commonValue,notActiveValue="0px "+this.commonValue;break;case this.options.bottomBorderButton:property="borderBottom",activeValue=c+this.commonValue,notActiveValue="0px "+this.commonValue;break;case this.options.topBorderButton:property="borderTop",activeValue=c+this.commonValue,notActiveValue="0px "+this.commonValue;break;case this.options.leftBorderButton:property="borderLeft",activeValue=c+this.commonValue,notActiveValue="0px "+this.commonValue;break;case this.options.rightBorderButton:property="borderRight",activeValue=c+this.commonValue,notActiveValue="0px "+this.commonValue;break;default:throw new Error("Check options: a button name cannot be found!")}a(d).hasClass("active")?(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+notActiveValue),this._setProperty(property,notActiveValue)):(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+activeValue),this._setProperty(property,activeValue))},_setProperty:function(b,c){a(this.options.targetClass).each(function(){a(this).css(b,c)})},refresh:function(){},_getWidth:function(){return a("#"+this.options.borderWidthElement+" option:selected").val()},_getWidthInPx:function(){return Math.ceil(72*a("#"+this.options.borderWidthElement+" option:selected").val()/25.4)+"px "},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.borderWidth",{options:{noneBorderButton:"BtnBorderNone",allBorderButton:"BtnBorderAll",bottomBorderButton:"BtnBorderBottom",topBorderButton:"BtnBorderTop",leftBorderButton:"BtnBorderLeft",rightBorderButton:"BtnBorderRight",borderWidthElement:"Element_border_width",targetClass:".elementSelected"},borderProperties:["borderBottom","borderTop","borderRight","borderLeft"],commonValue:"#000000 solid",_create:function(){this.list=this.element.delegate("select","change",a.proxy(this._itemChangeWidth,this)),this.refresh()},_itemChangeWidth:function(){a.revpdf.core.prototype.isDebug()&&console.log("Changing Border Width");var b=this._getWidthInPx(),c=this._getWidth(),d=[],e=this.borderProperties,f=this.commonValue,g=this;a.each([this.options.bottomBorderButton,this.options.topBorderButton,this.options.leftBorderButton,this.options.rightBorderButton],function(b,c){a("#"+c).hasClass("active")&&d.push(e[b])}),a.each(d,function(a,c){g._setProperty(c,b+f)}),g._setElementValue(c)},_setElementValue:function(b){a(this.options.targetClass).each(function(){a(this).trigger("setBorderWidth",[b])})},_setProperty:function(b,c){a(this.options.targetClass).each(function(){a(this).css(b,c)})},refresh:function(){},_getWidth:function(){return a("#"+this.options.borderWidthElement+" option:selected").val()},_getWidthInPx:function(){return Math.ceil(72*a("#"+this.options.borderWidthElement+" option:selected").val()/25.4)+"px "},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.divAlignment",{options:{alignLeftButton:"btnDivAlignLeft",alignTopButton:"btnDivAlignTop",alignBottomButton:"btnDivAlignBottom",alignRightButton:"btnDivAlignRight",targetClass:".elementSelected"},_create:function(){this.list=this.element.delegate("button.btn","click",a.proxy(this._itemClick,this)),this.refresh()},_itemClick:function(b){var c,d=this,e=""===a(b.target).prop("id")?a(b.target).parent():a(b.target);switch(e.prop("id")){case this.options.alignLeftButton:c=this._findLayer(this.options.targetClass,"minX"),a(this.options.targetClass).each(function(){var b=a(this).prop("id");if(c[0]!==b)if(d._collisionDetection("alignToLeft",c[0],b)===!1)pos=a("#"+c[0]).position().left,a("#"+b).css("left",pos);else{var e=a("#"+c[0]).getElementBorder();pos=a("#"+c[0]).position().left,a("#"+b).css("left",parseInt(pos+a("#"+c[0]).getElementWidth()+e[3].valueOf(),10))}}),this._setElementValue("posx");break;case this.options.alignRightButton:c=this._findLayer(this.options.targetClass,"maxX"),a(this.options.targetClass).each(function(){var b=a(this).prop("id");if(c[0]!==b)if(d._collisionDetection("alignToRight",c[0],b)===!1)pos=a("#"+c[0]).position().left,a("#"+b).css("left",a("#"+c[0]).position().left+a("#"+c[0]).getElementWidth()-a("#"+b).getElementWidth());else{var e=a("#"+c[0]).getElementBorder();pos=a("#"+c[0]).position().left,a("#"+b).css("left",parseInt(pos-a("#"+b).getElementWidth()-e[1].valueOf(),10))}}),this._setElementValue("posx");break;case this.options.alignTopButton:arrayY=this._findLayer(this.options.targetClass,"minY"),a(this.options.targetClass).each(function(){var b=a(this).prop("id");if(arrayY[0]!==b)if(d._collisionDetection("alignToTop",arrayY[0],b)===!1)pos=a("#"+arrayY[0]).position().top,a("#"+b).css("top",pos);else{var c=a("#"+arrayY[0]).getElementBorder();pos=a("#"+arrayY[0]).position().top,a("#"+b).css("top",parseInt(pos+a("#"+arrayY[0]).getElementHeight()+c[2].valueOf(),10))}}),this._setElementValue("posy");break;case this.options.alignBottomButton:arrayY=this._findLayer(this.options.targetClass,"maxY"),a(this.options.targetClass).each(function(){var b=a(this).prop("id");if(arrayY[0]!==b)if(d._collisionDetection("alignToBottom",arrayY[0],b)===!1)a("#"+b).setPositionY(arrayY[1]+a("#"+arrayY[0]).getElementHeight()-a("#"+b).getElementHeight());else{var c=a("#"+b).getElementBorder(),e=a("#"+arrayY[0]).position().top;a("#"+b).setPositionY(parseInt(e-a("#"+b).getElementHeight()-c[0].valueOf(),10))}}),this._setElementValue("posy");break;default:throw new Error("Check options: a button name cannot be found!")}},_setElementValue:function(b){a(this.options.targetClass).each(function(){a(this).trigger("setDivAlignement",[b])})},refresh:function(){},_collisionDetection:function(b,c,d){var e,f,g,h,i,j,k;if(e=[a("#"+d).getPositionX(),a("#"+d).getPositionY()],g=[a("#"+c).getPositionX()+a("#"+c).getElementWidth(),a("#"+c).getPositionY()],h=[a("#"+d).getPositionX()+a("#"+d).getElementWidth(),a("#"+d).getPositionY()],f=[a("#"+c).getPositionX(),a("#"+c).getPositionY()],j=[a("#"+c).getPositionX(),a("#"+c).getPositionY()+a("#"+c).getElementHeight()],k=[a("#"+d).getPositionX(),a("#"+d).getPositionY()+a("#"+d).getElementHeight()],i=[a("#"+c).getPositionX()+a("#"+c).getElementWidth(),a("#"+c).getPositionY()+a("#"+c).getElementHeight()],"alignToRight"==b||"alignToLeft"==b){if(k[1]-g[1]>0&&i[1]-k[1]>0)return!0;if(e[1]-g[1]>0&&i[1]-e[1]>0)return!0}else{if(h[0]-j[0]>0&&i[0]-h[0]>0)return!0;if(e[0]-j[0]>0&&i[0]-e[0]>0)return!0;if(e[0]==f[0])return!0;if(h[0]==g[0])return!0}return!1},_findLayer:function(b,c){var d=99999,e=0,f=[];switch(c){case"maxX":a(b).each(function(){arrayPos=a(this).getPositionX(),e=Math.max(e,parseInt(arrayPos,10)),e==parseInt(arrayPos,10)&&(f[0]=a(this).prop("id"),f[1]=e)});break;case"minX":a(b).each(function(){arrayPos=a(this).getPositionX(),d=Math.min(d,parseInt(arrayPos,10)),d==parseInt(arrayPos,10)&&(f[0]=a(this).prop("id"),f[1]=d)});break;case"maxY":a(b).each(function(){arrayPosY=a(this).getPositionY(),e=Math.max(e,parseInt(arrayPosY,10)),e==parseInt(arrayPosY,10)&&(f[0]=a(this).prop("id"),f[1]=e)});break;case"minY":a(b).each(function(){arrayPosY=a(this).getPositionY(),d=Math.min(d,parseInt(arrayPosY,10)),d==parseInt(arrayPosY,10)&&(f[0]=a(this).prop("id"),f[1]=d)});break;case"maxWidth":a(b).each(function(){array=a(this).getElementWidth(),e=Math.max(e,parseInt(array,10)),e==parseInt(array,10)&&(f[0]=a(this).prop("id"),f[1]=e)});break;case"minWidth":a(b).each(function(){array=a(this).getElementWidth(),d=Math.min(d,parseInt(array,10)),d==parseInt(array,10)&&(f[0]=a(this).prop("id"),f[1]=d)});break;case"minHeight":a(b).each(function(){array=a(this).getElementHeight(),d=Math.min(d,parseInt(array,10)),d==parseInt(array,10)&&(f[0]=a(this).prop("id"),f[1]=d)});break;case"maxHeight":a(b).each(function(){array=a(this).getElementHeight(),e=Math.max(e,parseInt(array,10)),e==parseInt(array,10)&&(f[0]=a(this).prop("id"),f[1]=e)})}return f},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.fontSize",{options:{fontSizeButton:"Element_size",fontNameButton:"Element_font_family",targetClass:".elementSelected"},_create:function(){this.list=this.element.delegate("select","change",a.proxy(this._itemClick,this)),this.refresh()},_itemClick:function(b){value=a("#"+a(b.target).prop("id")+" option:selected").val();var c=""===a(b.target).prop("id")?a(b.target).parent():a(b.target);switch(c.prop("id")){case this.options.fontSizeButton:property="fontSize",this._setProperty(property,value+"pt");break;case this.options.fontNameButton:property="fontFamily",this._setProperty(property,value);break;default:throw new Error("Check options: a button name cannot be found!")}this._setElementValue(value)},_setProperty:function(b,c){a.revpdf.core.prototype.isDebug()&&console.log("Setting "+b+" to "+c),a(this.options.targetClass).each(function(){a(this).css(b,c)})},_setElementValue:function(b){a(this.options.targetClass).each(function(){"fontFamily"==property?a(this).trigger("setFontFamily",[b]):a(this).trigger("setFontSize",[b])})},refresh:function(){},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.fontStyle",{options:{boldButton:"BtnFontStyleBold",italicButton:"BtnFontStyleItalic",underlineButton:"BtnFontStyleUnderlined",targetClass:".elementSelected"},_create:function(){this.list=this.element.delegate("button.btn","click",a.proxy(this._itemClick,this)),this.refresh()},_itemClick:function(b){var c=""===a(b.target).prop("id")?a(b.target).parent():a(b.target);switch(c.prop("id")){case this.options.boldButton:property="fontWeight",activeValue="bold",notActiveValue="normal";break;case this.options.italicButton:property="fontStyle",activeValue="italic",notActiveValue="normal";break;case this.options.underlineButton:property="textDecoration",activeValue="underline",notActiveValue="none";break;default:throw new Error("Check options: a button name cannot be found!")}a(c).hasClass("active")?(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+notActiveValue),this._setProperty(property,notActiveValue)):(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+activeValue),this._setProperty(property,activeValue))},_setProperty:function(b,c){a(this.options.targetClass).each(function(){a(this).css(b,c)})},_setElementValue:function(b){a(this.options.targetClass).each(function(){a(this).trigger("setFontStyle",[b])})},refresh:function(){},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.textAlignment",{options:{alignLeftButton:"btnAlignLeft",alignCenterButton:"btnAlignCenter",alignRightButton:"btnAlignRight",targetClass:".elementSelected"},_create:function(){this.list=this.element.delegate("button.btn","click",a.proxy(this._itemClick,this)),this.refresh()},_itemClick:function(b){var c=""===a(b.target).prop("id")?a(b.target).parent():a(b.target);switch(c.prop("id")){case this.options.alignLeftButton:property="textAlign",activeValue="left",notActiveValue="left";break;case this.options.alignCenterButton:property="textAlign",activeValue="center",notActiveValue="center";break;case this.options.alignRightButton:property="textAlign",activeValue="right",notActiveValue="right";break;default:throw new Error("Check options: a button name cannot be found!")}a(c).hasClass("active")?(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+notActiveValue),this._setProperty(property,notActiveValue)):(a.revpdf.core.prototype.isDebug()&&console.log("Setting "+property+" to "+activeValue),this._setProperty(property,activeValue))},_setProperty:function(b,c){a(this.options.targetClass).each(function(){a(this).css(b,c),a(this).trigger("setAlignment",[c.charAt(0).toUpperCase()])})},refresh:function(){},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery);var myElement=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this.elementID=b,this.elementPartId=a,this.elementType=c,this.elementField=d,this.elementFormat=e,this.elementFillColor=f,this.elementTextColor=g,this.elementBorder=h,this.elementBorderWidth=i,this.elementFontFamily=j,this.elementSize=k,this.elementAutoExtend=l,this.elementStyle=m,this.elementAlignment=n,this.elementPosX=o,this.elementPosY=p,this.elementPosXmm=o,this.elementPosYmm=p,this.elementHeightMM=q,this.elementWidthMM=r,this.updated=s,this.elementZIndex=t};myElement.prototype.getId=function(){return this.elementID},myElement.prototype.getPartId=function(){return this.elementPartId},myElement.prototype.getType=function(){return this.elementType},myElement.prototype.getField=function(){return this.elementField},myElement.prototype.getFormat=function(){return this.elementFormat},myElement.prototype.getFillColor=function(){return this.elementFillColor},myElement.prototype.getTextColor=function(){return this.elementTextColor},myElement.prototype.getBorder=function(){return this.elementBorder},myElement.prototype.getBorderWidth=function(){return this.elementBorderWidth},myElement.prototype.getFontFamily=function(){return this.elementFontFamily},myElement.prototype.getSize=function(){return this.elementSize},myElement.prototype.getAutoExtend=function(){return this.elementAutoExtend},myElement.prototype.getStyle=function(){return this.elementStyle},myElement.prototype.getAlignment=function(){return this.elementAlignment},myElement.prototype.getPosX=function(){return this.elementPosX},myElement.prototype.getPosY=function(){return this.elementPosY},myElement.prototype.getHeightMM=function(){return this.elementHeightMM},myElement.prototype.setHeight=function(a){this.elementHeight=a},myElement.prototype.getWidthMM=function(){return this.elementWidthMM},myElement.prototype.setWidth=function(a){this.elementWidth=a},myElement.prototype.getUpdated=function(){return this.updated},myElement.prototype.getZIndex=function(){return this.elementZIndex},function(a){a.widget("revpdf.elements",{options:{divPart:"",targetClass:".elementSelected"},_create:function(){var b=this;this.list=this.element.on("mousedown",function(c){a.revpdf.core.prototype.isDebug()&&console.log("Event::elements::mousedown");var d;d=c.shiftKey?!0:!1,b._select(this,d)}),a(this.element).draggable({containment:a("#"+this.options.divPart),grid:[4,4],collide:"block"}),a(this.element).hasClass("classImage")||a(this.element).resizable({containment:a("#"+this.options.divPart),grid:[4,4]}),this.refresh()},_select:function(b,c){a.revpdf.core.prototype.isDebug()&&console.log("select("+a(b).prop("id")+", "+c+")"),c===!1&&a(this.options.targetClass).each(function(){a(this).removeClass("elementSelected"),a(this).attr("opacity",1)}),a(b).hasClass("elementNotSelected")===!0&&a(b).setOpacity(1),a(b).addClass("elementSelected")},_setProperty:function(b,c){a(this.options.targetClass).each(function(){a(this).css(b,c)})},refresh:function(){},_setOption:function(a){this._superApply(arguments)},_destroy:function(){}})}(jQuery),function(a){a.widget("revpdf.core",{options:{debug:0,mmPxFactor:4,elementBoxUl:"elementBox",supportedElements:[["elementTextField","TextField"],["elementTextZone","TextZone"],["elementPageNumber","PageNumber"],["elementImage","Image"],["elementLine","Line"],["elementRectangle","Rectangle"],["elementRoundedBox","RoundedBox"]],report:{},formElementFillColor:"#Element_fill_color",formElementTextColor:"#Element_text_color",formElementBorderWidth:"#Element_border_width",formElementSize:"#Element_size",formElementFontFamily:"#Element_font_family",formElementPosXmm:"#Element_posxmm",formElementPosX:"#Element_posx",formElementPosYmm:"#Element_posymm",formElementPosY:"#Element_posy",formElementHeight:"#Element_height",formElementWidth:"#Element_width",formElementType:"#Element_type",formElementField:"#Element_element_field",formElementSelected:"#Element_formElementSelected",formElementZindex:"#Element_zindex",formElementSourceControl:"#Element_source_control",formElementFormat:"#Element_format",formElementIsAutoExtend:"#Element_is_auto_extend",menuGroupBorder:"#btnBorderButtons",menuBorderNoneButton:"#BtnBorderNone",menuBorderAllButton:"#BtnBorderAll",menuBorderBottomButton:"#BtnBorderBottom",menuBorderTopButton:"#BtnBorderTop",menuBorderLeftButton:"#BtnBorderLeft",menuBorderRightButton:"#BtnBorderRight",menuGroupFontstyle:"#btnFontstyleButtons",menuBoldButton:"#BtnFontStyleBold",menuItalicButton:"#BtnFontStyleItalic",menuUnderlineButton:"#BtnFontStyleUnderlined",menuGroupAlignement:"#btnAlignmentButtons",menuLeftAlignButton:"#btnAlignLeft",menuCenterAlignButton:"#btnAlignCenter",menuRightAlignButton:"#btnAlignRight",menuGroupDivAlignment:"#btnDivAlignmentButtons",menuDivAlignToLeftButton:"#btnDivAlignLeft",menuDivAlignToRightButton:"#btnDivAlignRight",menuDivAlignToBottomButton:"#btnDivAlignBottom",menuDivAlignToTopButton:"#btnDivAlignTop",menuFontColorPickerButton:"#fontColorPicker",menuFillColorPickerButton:"#fillColorPicker",targetClass:".elementSelected",saveButton:"#save-report-button",statusMessagesContainer:"#status-messages",deleteElementUrlInput:"#Element_delete_element_url"},isDebug:function(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&1==this.options.debug?!0:window.console&&(window.console.firebug||window.console.exception)&&1==this.options.debug?!0:!1},_create:function(){var b=this;this.buildContextualMenu(),a(document).mouseup(function(){b.isDebug()&&console.log("Event::document::mouseup"),a(b.options.targetClass).each(function(){b.updateElement(this)})}),a(this.options.saveButton).bind("click",function(c){a(this).button("loading"),c.preventDefault(),b.isDebug()&&console.groupCollapsed("Saving Report...");for(var d=b.options.report.getPartCount(),e=0,f=[],g=[],h="",i=0,j=null,k=0;d>k;k++){if(j=b.options.report.getPart(k),b.isDebug()&&console.groupCollapsed("PartID: "+j.getPartId()),b.options.report.setCurrentPartSelected(j.getPartId()),e=j.partElementList.length,e>0)for(var l=0;e>l;l++)h=j.partElementList[l].elementID,i=j.partElementList[l].updated,b.isDebug()&&console.log("Element: "+h+" / updated: "+i),void 0!==h&&0!==i&&j.setUpdated(!0);j.isUpdated()===!0&&(g[g.length]=j),b.isDebug()&&console.groupEnd()}f=JSON.stringify(g),b.isDebug()&&console.log("serialized values:"+f),b.isDebug()&&console.groupEnd();var m=a(this).data("href"),n="serialized="+encodeURIComponent(f);jQuery.ajax({url:m,type:"post",data:n,error:function(c,d,e){a(".message").remove(),a(b.options.statusMessagesContainer).removeClass("alert-success").addClass("alert-error");var f=JSON.parse(c.responseText);msg=void 0!==typeof f.message?f.message:e,a(b.options.statusMessagesContainer).append('<p class="message">['+c.status+"]: "+msg+"("+d+")</p>").show().fadeOut(7e3),a(b.options.saveButton).button("reset"),b.isDebug()&&console.log("NOT saved!")},success:function(c){a(".message").remove(),"KO"==c.status?a(b.options.statusMessagesContainer).removeClass("alert-success").addClass("alert-error"):a(b.options.statusMessagesContainer).removeClass("alert-error").addClass("alert-success"),a(b.options.statusMessagesContainer).append('<p class="message">'+c.message+"</p>").show().fadeOut(7e3),a(b.options.saveButton).button("reset"),b.isDebug()&&console.log("Saved!")}})}),a(this.options.formElementPosXmm).bind("change",function(){a(b.options.targetClass).each(function(){a(this).setPositionX(parseInt(a(b.options.formElementPosXmm).val()*b.options.mmPxFactor,10)),b.updateElement(this,"elementPosXmm")})}),a(this.options.formElementPosYmm).bind("change",function(){a(b.options.targetClass).each(function(){a(this).setPositionY(parseInt(a(b.options.formElementPosYmm).val()*b.options.mmPxFactor,10)),b.updateElement(this,"elementPosYmm")})}),a(this.options.formElementWidth).bind("change",function(){var c,d;a(b.options.targetClass).each(function(){c=a(this).getElementBorder(),d=b.options.report.getReportWidth()-c[1].valueOf()-c[3].valueOf(),parseInt(a(b.options.formElementWidth).val()*b.options.report.getMmPxFactor(),10)>d&&a(b.options.formElementWidth).val(b.options.report.getReportWidth()/b.options.report.getMmPxFactor()),a(this).setElementWidth(a(b.options.formElementWidth).val()*b.options.report.getMmPxFactor()),b.updateElement(this,"elementWidthMM")})}),a(this.options.formElementHeight).bind("change",function(){var c,d;a(b.options.targetClass).each(function(){c=a(this).getElementBorder(),d=parseInt(a(this).parent().height()-c[0].valueOf()-c[2].valueOf(),10),parseInt(a(b.options.formElementHeight).val()*b.options.report.getMmPxFactor(),10)>d&&a(b.options.formElementHeight).val(a(this).parent().height()/b.options.report.getMmPxFactor()),a(this).setElementHeight(a(b.options.formElementHeight).val()*b.options.report.getMmPxFactor()),b.updateElement(this,"elementHeightMM")})}),a(this.options.formElementField).bind("change",function(){a(b.options.targetClass).each(function(){a(this).hasClass("classImage")?a(this).attr("src",a(b.options.formElementField).val()):(a("#"+a(this).prop("id")+" > span").text(a(b.options.formElementField).val()),a(this).attr("title",a(b.options.formElementField).val()+" ("+a(b.options.formElementType).val()+")")),b.updateElement(this,"elementField")})}),a(this.options.formElementFormat).bind("change",function(){a(b.options.targetClass).each(function(){b.updateElement(this,"elementFormat")})}),a(this.options.formElementZindex).bind("change",function(){a(b.options.targetClass).each(function(){a(this).setZIndex(a(b.options.formElementZindex).val()),b.updateElement(this,"elementZIndex")})}),a(this.options.formElementIsAutoExtend).bind("change",function(){a(b.options.targetClass).each(function(){b.updateElement(this,"elementAutoExtend")})}),a(this.options.formElementSourceControl).bind("change",function(){a(b.options.targetClass).each(function(){a(b.options.formElementField).val(a(b.options.formElementSourceControl).val()),a(b.options.formElementField).trigger("change")})}),a(this.options.menuGroupBorder+" > button").bind("click",function(){var c="#"+a(this).prop("id"),d="";c==b.options.menuBorderAllButton&&(d="LRTB"),c==b.options.menuBorderTopButton&&(d="T"),c==b.options.menuBorderBottomButton&&(d="B"),c==b.options.menuBorderRightButton&&(d="R"),c==b.options.menuBorderLeftButton&&(d="L"),a(b.options.targetClass).each(function(){b.updateElement(this,"elementBorder",d)})}),a(this.options.menuGroupFontstyle+" > button").bind("click",function(){var c="#"+a(this).prop("id"),d="";c==b.options.menuBoldButton&&(d="B"),c==b.options.menuItalicButton&&(d="I"),c==b.options.menuUnderlineButton&&(d="U"),a(b.options.targetClass).each(function(){b.updateElement(this,"elementStyle",d)})}),a(this.options.menuFontColorPickerButton).colorpicker().on("changeColor",function(c){a(b.options.targetClass).each(function(){b.isDebug()&&console.log("Text Color changed to: "+c.color.toHex()),a(this).setTextColor(c.color.toHex())})}).on("hide",function(c){a(b.options.targetClass).each(function(){b.updateElement(this,"elementTextColor",c.color.toHex())})}),a(this.options.menuFillColorPickerButton).colorpicker().on("changeColor",function(c){a(".elementSelected").each(function(){b.isDebug()&&console.log("Fill Color changed to: "+c.color.toHex()),a(this).setFillColor(c.color.toHex())})}).on("hide",function(c){a(b.options.targetClass).each(function(){b.updateElement(this,"elementFillColor",c.color.toHex())})}),a(this.options.menuGroupDivAlignment+" > button").bind("click",function(){var c="#"+a(this).prop("id"),d="";c==b.options.menuDivAlignToLeftButton&&(d="posx"),c==b.options.menuDivAlignToRightButton&&(d="posx"),c==b.options.menuDivAlignToBottomButton&&(d="posy"),c==b.options.menuDivAlignToTopButton&&(d="posy"),a(b.options.targetClass).each(function(){b.updateElement(this,"elementDivAlignment",d)})}),a.each(this.options.supportedElements,function(c,d){a("#"+b.options.elementBoxUl).append('<li id="'+d[0]+'" data-elementtype="'+d[1]+'"><i class="icon-rev icon-'+d[1].toLowerCase()+'"></i>'+d[1]+"</li>"),a("#"+d[0])&&a("#"+d[0]).draggable({revert:!0,helper:"clone"}),a("#"+d[0]).dblclick(function(){b.addElement(d[1])})});var c="";a.each(this.options.report.partList,function(a,b){c+=b.getTemplate()}),a(b.element).html(c),a(".part-header > span").each(function(c,d){a(d).bind("click",function(){var c=a(this).parent().parent().parent().attr("id");splitted=c.split("-"),b.togglePartSelection(splitted[1])})}),a.each(this.options.report.partList,function(a,c){0===a&&b.togglePartSelection(c.getId())}),a.each(this.options.report.partList,function(c,d){var e=this.getId();if(a("#part_"+e).droppable({accept:"#elementTextField, #elementTextZone, #elementPageNumber, #elementImage, #elementLine,  #elementRectangle, #elementRoundedBox",drop:function(c,d){b.addElement(a(d.draggable).data("elementtype"))},over:function(){b.togglePartSelection(e)}}),a("#part_"+e).resizable({grid:[4,4],handles:"s",resize:function(c,e){d.setHeightFromPx(e.element.height(),b.options.report.getMmPxFactor()),a("#height-"+d.getPartId()).val(d.getPartHeight())}}),nbElement=this.getElements().length,b.isDebug()&&(console.groupCollapsed("Part.prototype.display"),console.log("Part ID: "+this.getId()),console.log("Part ReportID: "+this.getPartReportId()),console.log("Part number: "+this.getPartNumber()),console.log("Part height: "+this.getPartHeight()),console.log("Element(s) nb : "+nbElement)),nbElement>0)for(var f,g,h=0;nbElement>h;h++){f=this.getElement(h),b.isDebug()&&(console.groupCollapsed("Element ID:"+f.getId()),console.dir(f),console.groupEnd());
var i="class"+f.getType();g="Image"!==f.getType()?'<div id="'+f.getId()+'" class="'+i+'"  title="'+f.getField()+" ("+f.getType()+')" style="position: absolute;"><span></span></div>':'<img title="'+f.getType()+'" style="position: absolute; max-height: '+a("#part"+this.getId()).height()+"px; max-width: "+a("#part"+this.getId()).width()+'px" id="'+f.getId()+'" class="'+i+'" id="'+f.getId()+'" src="'+f.getField()+'" alt="'+f.getField()+'" />',a(g).appendTo(a("#part_"+this.getPartId())),a("#"+f.getId()).setPositionX(this.partElementList[h].elementPosX),a("#"+f.getId()).setPositionY(this.partElementList[h].elementPosY),a("#"+f.getId()).setBorder(this.partElementList[h].elementBorder,this.partElementList[h].elementBorderWidth),a("#"+f.getId()).setElementHeight(this.partElementList[h].elementHeightMM*b.options.report.getMmPxFactor()),a("#"+f.getId()).setElementWidth(this.partElementList[h].elementWidthMM*b.options.report.getMmPxFactor()),a("#"+f.getId()+" > span").setField(f.getField()),a("#"+f.getId()).setFillColor(this.partElementList[h].elementFillColor),a("#"+f.getId()).setTextColor(this.partElementList[h].elementTextColor),a("#"+f.getId()).setFontStyle(this.partElementList[h].elementStyle),a("#"+f.getId()).setAlignment(this.partElementList[h].elementAlignment),a("#"+f.getId()).setFontSize(this.partElementList[h].elementSize),a("#"+f.getId()).setFontFamily(this.partElementList[h].elementFontFamily),a("#"+f.getId()).elements({divPart:"part_"+this.getPartId()}),a("#"+f.getId()).bind("drag",function(a,c){b.dragEvent(a,c)}).bind("resize",function(a,c){b.resizeEvent(a,c)}),a("#"+f.getId()).bind("mouseup",function(){b.isDebug()&&console.log("Event::revpdf::mouseup"),b.updateElement(this)}),a("#"+f.getId()).bind("mousedown",function(){b.isDebug()&&console.log("Event::revpdf::mousedown"),b.togglePartSelection(d.getPartId()),b.setFormValues(a(this))}),a("#"+f.getId()).bind("setAlignment",function(a,c){b.isDebug()&&console.log("Event::revpdf::setAlignment"),b.updateElement(this,"elementAlignment",c)}),a("#"+f.getId()).bind("setFontStyle",function(a,c){b.isDebug()&&console.log("Event::revpdf::setFontStyle"),b.updateElement(this,"elementStyle",c)}),a("#"+f.getId()).bind("setFontFamily",function(a,c){b.isDebug()&&console.log("Event::revpdf::setFontFamily"),b.updateElement(this,"elementFontFamily",c)}),a("#"+f.getId()).bind("setFontSize",function(a,c){b.isDebug()&&console.log("Event::revpdf::setFontSize"),b.updateElement(this,"elementSize",c)}),a("#"+f.getId()).bind("setBorderWidth",function(a,c){b.isDebug()&&console.log("Event::revpdf::setBorderWidth"),b.updateElement(this,"elementBorderWidth",c)}),a("#"+f.getId()).bind("setBorder",function(a,c){b.isDebug()&&console.log("Event::revpdf::setBorder"),b.updateElement(this,"elementBorder",c)}),a("#"+f.getId()).bind("setDivAlignement",function(a,c){b.isDebug()&&console.log("Event::revpdf::setDivAlignement"),b.updateElement(this,"elementDivAlignment",c)})}b.isDebug()&&console.groupEnd()}),this.refresh()},dragEvent:function(b,c){a(this.options.formElementPosX).val(c.helper.getPositionX()),a(this.options.formElementPosY).val(c.helper.getPositionY()),a(this.options.formElementPosXmm).val(Math.round(Number(c.helper.getPositionX())/this.options.report.getMmPxFactor())),a(this.options.formElementPosYmm).val(Math.round(Number(c.helper.getPositionY())/this.options.report.getMmPxFactor()))},resizeEvent:function(b,c){a(this.options.formElementHeight).val(parseInt(c.element.height()/this.options.report.getMmPxFactor(),10)),a(this.options.formElementWidth).val(parseInt(c.element.width()/this.options.report.getMmPxFactor(),10))},refresh:function(){},addElement:function(b,c){var d=this,e="",f=this.options.report.getCurrentPartDivSelected(),g=this.options.report.getPartById(this.options.report.getCurrentPartSelected());this.isDebug()&&console.log("Adding element "+b+" to "+f),a('<div id="tmpElement" class="class'+b+'" style="position: absolute;"><span>'+e+"</span></div>").appendTo(a("#"+f));var h,i,j="LRTB",k=0,l="",m=0,n="L",o="FFFFFF",p="000000",q=.2,r=12,s="text",t="helvetica",u=a("#tmpElement").getElementHeight(),v=a("#tmpElement").getElementHeight()/this.options.report.getMmPxFactor(),w=a("#tmpElement").getElementWidth(),x=a("#tmpElement").getElementWidth()/this.options.report.getMmPxFactor(),y=a("#tmpElement").getPositionX(),z=a("#tmpElement").getPositionY(),A=1;c&&(e=c.elementField,j=c.elementBorder,k=c.elementAutoExtend,l=c.elementStyle,m=c.elementZIndex,n=c.elementAlignment,s=c.elementFormat,o=c.elementFillColor,p=c.elementTextColor,q=c.elementBorderWidth,r=c.elementSize,t=c.elementFontFamily,u=c.elementHeight,w=c.elementWidth,v=c.elementHeightMM,x=c.elementWidthMM,y=c.elementPosX,z=c.elementPosY),a(this.options.formElementFillColor).val(o),a(this.options.formElementTextColor).val(p),a(this.options.formElementBorderWidth).val(q),a(this.options.formElementSize).val(r),a(this.options.formElementFontFamily).val(t),a(this.options.formElementHeight).val(v),a(this.options.formElementWidth).val(x),h=document.getElementsByClassName("class"+b),"PageNumber"==b&&(e="Page {cur}/{nb}"),"TextZone"==b&&(e=a(this.options.formElementSourceControl).val()),("Rectangle"==b||"RoundedBox"==b)&&a(this.options.formElementFillColor).val(""),a("#tmpElement").attr("title",e+" ("+b+")"),a("#tmpElement > span").setField(e),a("#tmpElement").setFontSize(a(this.options.formElementSize).val()),a("#tmpElement").setFontFamily(a(this.options.formElementFontFamily).val()),a("#tmpElement").setFillColor(o),a("#tmpElement").setTextColor(p),a("#tmpElement").setFontStyle(l),a("#tmpElement").setBorder(j,a(this.options.formElementBorderWidth).val()),a("#tmpElement").setAlignment(n),a("#tmpElement").setZIndex(m),a("#tmpElement").setElementHeight(u),a("#tmpElement").setElementWidth(w,this.options.report.getReportWidth()),a("#tmpElement").elements({divPart:f}),a("#tmpElement").bind("drag",function(a,b){d.dragEvent(a,b)}).bind("resize",function(a,b){d.resizeEvent(a,b)}),a("#tmpElement").attr("id",b+(h.length+1)),i=a("#"+b+(h.length+1));var B=new myElement(g.getPartId(),i.attr("id"),b,e,s,a(this.options.formElementFillColor).val(),a(this.options.formElementTextColor).val(),j,a(this.options.formElementBorderWidth).val(),a(this.options.formElementFontFamily).val(),a(this.options.formElementSize).val(),k,l,n,y,z,v,x,A,a(this.options.formElementZindex).val());B.setHeight(v*this.options.report.getMmPxFactor()),B.setWidth(x*this.options.report.getMmPxFactor()),g.addElement(B),this.isDebug()&&(console.groupCollapsed("addElement("+b+", "+c+")"),console.log(" - part Id: "+g.getPartId()),console.log(" - element Id: "+i.attr("id")),console.log(" - element type: "+b),console.log(" - element Field: "+e),console.log(" - element Pos X: "+y),console.log(" - element Pos Y: "+z),console.log(" - element Height: "+u),console.log(" - element Width: "+w),console.log(" - element Height MM: "+v),console.log(" - element Width MM: "+x),console.log(" - form element format: "+a(this.options.formElementFormat).val()),console.log(" - formElementFillColor: "+a(this.options.formElementFillColor).val()),console.log(" - form element text color: "+a(this.options.formElementTextColor).val()),console.log(" - element border: "+j),console.log(" - form element border width: "+a(this.options.formElementBorderWidth).val()),console.log(" - form Element Font Family "+a(this.options.formElementFontFamily).val()),console.log(" - form Element Size: "+a(this.options.formElementSize).val()),console.log(" - element Auto Extend: "+k),console.log(" - element style: "+l),console.log(" - element Text Alignment: "+n),console.log(" - element Updated "+A),console.log(" - form ZIndex: "+a(this.options.formElementZindex).val()),console.groupEnd()),a(i).bind("mouseup",function(){d.isDebug()&&console.log("Event::revpdf::mouseup"),d.updateElement(this)}),a(i).bind("mousedown",function(){d.isDebug()&&console.log("Event::revpdf::mousedown"),d.togglePartSelection(g.getPartId()),d.setFormValues(a(this))}),a(i).trigger("mousedown"),a(i).trigger("mouseup")},buildContextualMenu:function(){var b=this;a.contextMenu({selector:".classImage, .classLine, .classRectangle, .classRoundedBox, .classPageNumber, .classTextField, .classTextZone",items:{duplicate:{name:"Duplicate",icon:"copy",callback:function(a,c){var d=c.$trigger.attr("id"),e=b.options.report.getPartById(b.options.report.currentPartSelected),f=e.getElements().length,g=!1;if(f>0){for(var h=0;f>h;h++)if(e.partElementList[h].elementID==d){g=!0,elementId_new=d+"_2",elementPartId=e.partElementList[h].elementPartId,elementType=e.partElementList[h].elementType,elementField=e.partElementList[h].elementField,elementFormat=e.partElementList[h].elementFormat,elementFillColor=e.partElementList[h].elementFillColor,elementTextColor=e.partElementList[h].elementTextColor,elementBorder=e.partElementList[h].elementBorder,elementBorderWidth=e.partElementList[h].elementBorderWidth,elementSize=e.partElementList[h].elementSize,elementAutoExtend=e.partElementList[h].elementAutoExtend,elementFontFamily=e.partElementList[h].elementFontFamily,elementStyle=e.partElementList[h].elementStyle,elementAlignment=e.partElementList[h].elementAlignment,elementPosX=e.partElementList[h].elementPosX,elementPosY=e.partElementList[h].elementPosY,elementHeight=e.partElementList[h].elementHeight/b.options.report.getMmPxFactor(),elementWidth=e.partElementList[h].elementWidth/b.options.report.getMmPxFactor(),elementZIndex=e.partElementList[h].elementZIndex;break}if(g){var i=new myElement(elementPartId,elementId_new,elementType,elementField,elementFormat,elementFillColor,elementTextColor,elementBorder,elementBorderWidth,elementFontFamily,elementSize,elementAutoExtend,elementStyle,elementAlignment,elementPosX,elementPosY,elementHeight,elementWidth,"1",elementZIndex);b.addElement(elementType,i)}}}},"delete":{name:"Delete",icon:"delete",callback:function(c,d){var e=d.$trigger.attr("id"),f=b.options.report.getPartById(b.options.report.getCurrentPartSelected());f.deleteElement(e);var g=a(b.options.deleteElementUrlInput).val(),h="elementId="+e;jQuery.ajax({url:g,type:"post",data:h,beforeSend:function(){a("#"+e).fadeOut(2e3)}})}}},zIndex:1001}),a(".classTextField").on("click",function(){console.log("clicked",this)})},resizeElementEvent:function(b,c){a(this.options.formElementHeight).val(parseInt(c.element.height()/this.options.report.getMmPxFactor(),10)),a(this.options.formElementWidth).val(parseInt(c.element.width()/this.options.report.getMmPxFactor(),10))},togglePartSelection:function(b){this.isDebug()&&console.log("togglePartSelection("+b+")"),this.options.report.setCurrentPartSelected(b),a(".part-global").each(function(){a(this).removeClass("classPartSelected").addClass("classPartNotSelected")}),a("#part-"+b).removeClass("classPartNotSelected").addClass("classPartSelected")},updateElement:function(b,c,d){var e=!0;this.isDebug()&&console.groupCollapsed("update Element (id="+a(b).attr("id")+") (prop="+c+" | value="+d+")");var f=this.options.report.getPartById(this.options.report.currentPartSelected),g=f.getElements().length;if(g>0&&""!==a(b).attr("id"))for(var h=0;g>h;h++)if(f.partElementList[h].elementID==a(b).attr("id")){if(f.partElementList[h].updated=1,("elementType"==c||"undefined"==typeof c)&&(f.partElementList[h].elementType=a(this.options.formElementType).val()),("elementField"==c||"undefined"==typeof c)&&(f.partElementList[h].elementField=a(this.options.formElementField).val()),("elementFormat"==c||"undefined"==typeof c)&&(f.partElementList[h].elementFormat=a(this.options.formElementFormat).val()),("elementFillColor"==c||"undefined"==typeof c)&&(f.partElementList[h].elementFillColor=a(this.options.formElementFillColor).val()),("elementTextColor"==c||"undefined"==typeof c)&&(f.partElementList[h].elementTextColor=a(this.options.formElementTextColor).val()),("elementBorder"==c||"undefined"==typeof c)&&"undefined"!=typeof d){var i=f.partElementList[h].elementBorder;"-1"==i.indexOf(d)?f.partElementList[h].elementBorder+=d:f.partElementList[h].elementBorder=f.partElementList[h].elementBorder.replace(d,""),e=!1}if(("elementBorderWidth"==c||"undefined"==typeof c)&&(f.partElementList[h].elementBorderWidth="undefined"==typeof d?a(this.options.formElementBorderWidth).val():d),("elementSize"==c||"undefined"==typeof c)&&(f.partElementList[h].elementSize="undefined"==typeof d?a(this.options.formElementSize).val():d),("elementAutoExtend"==c||"undefined"==typeof c)&&(f.partElementList[h].elementAutoExtend=a(this.options.formElementIsAutoExtend).val()),("elementFontFamily"==c||"undefined"==typeof c)&&(f.partElementList[h].elementFontFamily="undefined"==typeof d?a(this.options.formElementFontFamily).val():d),("elementZIndex"==c||"undefined"==typeof c)&&(f.partElementList[h].elementZIndex=a(this.options.formElementZindex).val()),("elementStyle"==c||"undefined"==typeof c)&&"undefined"!=typeof d){var j=f.partElementList[h].elementStyle;"-1"==j.indexOf(d)?f.partElementList[h].elementStyle+=d:f.partElementList[h].elementStyle=f.partElementList[h].elementStyle.replace(d,""),e=!1}("elementAlignment"==c||"undefined"==typeof c)&&("undefined"!=typeof d?formElementAlignment=d:a(this.options.menuGroupAlignement+" > button").each(function(b,c){a(c).hasClass("active")&&(formElementAlignment=a(c).data("align"))}),f.partElementList[h].elementAlignment=formElementAlignment),("elementDivAlignment"==c||"undefined"==typeof c)&&("posx"==d&&(f.partElementList[h].elementPosX=a(b).getPositionX(),f.partElementList[h].elementPosXmm=a(b).getPositionX()/this.options.report.getMmPxFactor()),"posy"==d&&(f.partElementList[h].elementPosY=a(b).getPositionY(),f.partElementList[h].elementPosYmm=a(b).getPositionY()/this.options.report.getMmPxFactor())),("elementPosX"==c||"undefined"==typeof c)&&(f.partElementList[h].elementPosX=a(b).getPositionX(),f.partElementList[h].elementPosXmm=a(b).getPositionX()/this.options.report.getMmPxFactor()),("elementPosY"==c||"undefined"==typeof c)&&(f.partElementList[h].elementPosY=a(b).getPositionY(),f.partElementList[h].elementPosYmm=a(b).getPositionY()/this.options.report.getMmPxFactor()),("elementPosXmm"==c||"undefined"==typeof c)&&(f.partElementList[h].elementPosX=a(b).getPositionX(),f.partElementList[h].elementPosXmm=a(b).getPositionX()/this.options.report.getMmPxFactor()),("elementPosYmm"==c||"undefined"==typeof c)&&(f.partElementList[h].elementPosY=a(b).getPositionY(),f.partElementList[h].elementPosYmm=a(b).getPositionY()/this.options.report.getMmPxFactor()),("elementHeightMM"==c||"undefined"==typeof c)&&(f.partElementList[h].elementHeightMM=a(this.options.formElementHeight).val()),("elementWidthMM"==c||"undefined"==typeof c)&&(f.partElementList[h].elementWidthMM=a(this.options.formElementWidth).val())}e&&this.setFormValues(a(b)),this.isDebug()&&console.groupEnd()},setFormValues:function(b){var c=0,d=b.prop("id");this.isDebug()&&console.groupCollapsed("setFormValues("+d+")");for(var e=this.options.report.getPartById(this.options.report.currentPartSelected),f=e.getElements().length,g=0;f>g;g++)if(e.partElementList[g].elementID==d){this.isDebug()&&(console.groupCollapsed("Element values"),console.log("Element ID: "+d),console.log("PosX: "+e.partElementList[g].elementPosX),console.log("PosXmm: "+Math.round(Number(e.partElementList[g].elementPosX)/this.options.report.getMmPxFactor())),console.log("PosY: "+e.partElementList[g].elementPosY),console.log("PosYmm: "+Math.round(Number(e.partElementList[g].elementPosY)/this.options.report.getMmPxFactor())),console.log("width: "+parseInt(e.partElementList[g].elementWidthMM,10)),console.log("height: "+parseInt(e.partElementList[g].elementHeightMM,10)),console.log("alignment: "+e.partElementList[g].elementAlignment),console.log("element_field: "+e.partElementList[g].elementField),console.log("style: "+e.partElementList[g].elementStyle),console.log("format: "+e.partElementList[g].elementFormat),console.log("fill_color: "+e.partElementList[g].elementFillColor),console.log("text_color: "+e.partElementList[g].elementTextColor),console.log("type: "+e.partElementList[g].elementType),console.log("border: "+e.partElementList[g].elementBorder),console.log("border_width: "+e.partElementList[g].elementBorderWidth),console.log("size: "+e.partElementList[g].elementSize),console.log("is_auto_extend: "+e.partElementList[g].elementAutoExtend),console.log("font_family: "+e.partElementList[g].elementFontFamily),console.log("zindex: "+e.partElementList[g].elementZIndex),console.log("updated: "+e.partElementList[g].updated)),a(this.options.formElementPosX).val(e.partElementList[g].elementPosX),a(this.options.formElementPosY).val(e.partElementList[g].elementPosY),a(this.options.formElementPosXmm).val(Math.round(Number(e.partElementList[g].elementPosXmm))),a(this.options.formElementPosYmm).val(Math.round(Number(e.partElementList[g].elementPosYmm))),a(this.options.formElementWidth).val(parseInt(e.partElementList[g].elementWidthMM,10)),a(this.options.formElementHeight).val(parseInt(e.partElementList[g].elementHeightMM,10)),a(this.options.formElementField).val(e.partElementList[g].elementField),a(this.options.formElementFormat).val(e.partElementList[g].elementFormat),a(this.options.formElementFillColor).val(e.partElementList[g].elementFillColor),a(this.options.formElementTextColor).val(e.partElementList[g].elementTextColor),a(this.options.formElementType).val(e.partElementList[g].elementType),a(this.options.formElementBorderWidth).val(e.partElementList[g].elementBorderWidth),a(this.options.formElementSize).val(e.partElementList[g].elementSize),a(this.options.formElementIsAutoExtend).val(e.partElementList[g].elementAutoExtend),a(this.options.formElementFontFamily).val(e.partElementList[g].elementFontFamily),a(this.options.formElementZindex).val(e.partElementList[g].elementZIndex),this.isDebug()&&console.groupEnd(),this.isDebug()&&(console.groupCollapsed("Form values"),console.log("Element ID: "+d),console.log("PosX: "+a(this.options.formElementPosX).val()),console.log("PosY: "+a(this.options.formElementPosY).val()),console.log("PosXmm: "+a(this.options.formElementPosXmm).val()),console.log("PosYmm: "+a(this.options.formElementPosYmm).val()),console.log("width: "+a(this.options.formElementWidth).val()),console.log("height: "+a(this.options.formElementHeight).val()),console.log("element_field: "+a(this.options.formElementField).val()),console.log("format: "+a(this.options.formElementFormat).val()),console.log("fill_color: "+a(this.options.formElementFillColor).val()),console.log("text_color: "+a(this.options.formElementTextColor).val()),console.log("type: "+a(this.options.formElementType).val()),console.log("border_width: "+a(this.options.formElementBorderWidth).val()),console.log("size: "+a(this.options.formElementSize).val()),console.log("is_auto_extend: "+a(this.options.formElementIsAutoExtend).val()),console.log("font_family: "+a(this.options.formElementFontFamily).val()),console.log("zindex: "+a(this.options.formElementZindex).val()),console.groupEnd()),a.each([this.options.menuBorderNoneButton,this.options.menuBorderAllButton,this.options.menuBorderBottomButton,this.options.menuBorderTopButton,this.options.menuBorderLeftButton,this.options.menuBorderRightButton],function(b,c){a(c).removeClass("active")});var h=e.partElementList[g].elementBorder.length;if(h>0)if("lrbt"==e.partElementList[g].elementBorder.toLowerCase())a(this.options.menuBorderAllButton).addClass("active");else for(c=0;h>c;c++){var i=e.partElementList[g].elementBorder.charAt(c);a.each([this.options.menuBorderNoneButton,this.options.menuBorderAllButton,this.options.menuBorderBottomButton,this.options.menuBorderTopButton,this.options.menuBorderLeftButton,this.options.menuBorderRightButton],function(b,c){a(c).data("style").toLowerCase()==i.toLowerCase()&&a(c).addClass("active")})}else a(this.options.menuBorderNoneButton).addClass("active");a.each([this.options.menuBoldButton,this.options.menuItalicButton,this.options.menuUnderlineButton],function(b,c){a(c).removeClass("active")});var j=e.partElementList[g].elementStyle.length;if(j>0)for(c=0;j>c;c++){var k=e.partElementList[g].elementStyle.charAt(c);a.each([this.options.menuBoldButton,this.options.menuItalicButton,this.options.menuUnderlineButton],function(b,c){a(c).data("style").toUpperCase()==k.toUpperCase()&&a(c).addClass("active")})}a(this.options.menuFontColorPickerButton+" .icon-BtnFontColor").css({backgroundColor:"#"+e.partElementList[g].elementTextColor}),a(this.options.menuFillColorPickerButton+" .icon-BtnFillColor").css({backgroundColor:"#"+e.partElementList[g].elementFillColor});var l=e.partElementList[g].elementAlignment;a.each([this.options.menuLeftAlignButton,this.options.menuCenterAlignButton,this.options.menuRightAlignButton],function(b,c){a(c).removeClass("active"),l.toUpperCase()==a(c).data("align")&&a(c).addClass("active")}),"Image"==a(this.options.formElementType).val()||"RoundedBox"==a(this.options.formElementType).val()||"PageNumber"==a(this.options.formElementType).val()?(a(this.options.formElementFormat).hide(),a(this.options.formElementSourceControl).hide(),a(this.options.formElementField).show(),a(this.options.formElementHeight).removeAttr("disabled")):"TextField"==a(this.options.formElementType).val()?(a(this.options.formElementSourceControl).hide(),a(this.options.formElementField).show()):"TextZone"==a(this.options.formElementType).val()&&(a(this.options.formElementFormat).show(),a(this.options.formElementSourceControl).show(),a(this.options.formElementField).hide(),a(this.options.formElementHeight).removeAttr("disabled"),a(this.options.formElementField).val(e.partElementList[g].elementField),a(this.options.formElementSourceControl).val(e.partElementList[g].elementField));break}this.isDebug()&&console.groupEnd()},_setOption:function(b){a.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery);var Part=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.partEditUrl=n,this.name=k,this.id=a,this.partId=a,this.partReportId=b,this.partNumber=c,this.width=l,this.height=d,this.heightMM=m,this.is_visible=e,this.is_page_jump=f,this.is_indivisible=g,this.is_auto_extend=h,this.is_auto_reduc=i,this.sort_order=j,this.partElementList=[],this.updated=!1};Part.prototype.addElement=function(a){this.partElementList.push(a)},Part.prototype.getElements=function(){return this.partElementList},Part.prototype.getElement=function(a){return this.partElementList[a]},Part.prototype.setHeight=function(a){this.height=parseInt(a,10)},Part.prototype.setHeightFromPx=function(a,b){this.height=parseInt(a/b,10),this.heightMM=parseInt(a,10),this.updated=!0},Part.prototype.getPartHeight=function(){return parseInt(this.height,10)},Part.prototype.getPartHeightMM=function(){return parseInt(this.heightMM,10)},Part.prototype.getPartWidth=function(){return parseInt(this.width,10)},Part.prototype.getPartNumber=function(){return parseInt(this.partNumber,10)},Part.prototype.getPartReportId=function(){return this.partReportId},Part.prototype.getPartName=function(){return this.name},Part.prototype.getPartEditUrl=function(){return this.partEditUrl},Part.prototype.getPartId=function(){return this.partId},Part.prototype.getId=function(){return this.id},Part.prototype.setId=function(a){this.id=parseInt(a,10)},Part.prototype.isUpdated=function(){return this.updated},Part.prototype.setUpdated=function(a){this.updated=Boolean(a)},Part.prototype.setIsVisible=function(a){this.is_visible=Boolean(a)},Part.prototype.isVisible=function(){return Boolean(this.is_visible)},Part.prototype.setIsPageJump=function(a){this.is_page_jump=Boolean(a)},Part.prototype.isPageJump=function(){return Boolean(this.is_page_jump)},Part.prototype.setIsIndivisible=function(a){this.is_indivisible=Boolean(a)},Part.prototype.isIndivisible=function(){return Boolean(this.is_indivisible)},Part.prototype.setIsAutoExtend=function(a){this.is_auto_extend=Boolean(a)},Part.prototype.isAutoExtend=function(){return Boolean(this.is_auto_extend)},Part.prototype.setIsAutoReduc=function(a){this.is_auto_reduc=Boolean(a)},Part.prototype.isAutoReduc=function(){return Boolean(this.is_auto_reduc)},Part.prototype.setSortOrder=function(a){this.sort_order=a},Part.prototype.getSortOrder=function(){return this.sort_order},Part.prototype.deleteElement=function(a){for(var b in this.partElementList)if(this.partElementList[b].elementID==a){this.partElementList.splice(b);break}},Part.prototype.getTemplate=function(){var a="<div id='part-"+this.id+"' class='part-global classPartNotSelected' data-partid='"+this.id+"'><div id='inner-part-"+this.id+"' style='width:"+this.width+"px'><div id='part-header"+this.id+"' class='part-header'><a id='edit-paste-link-"+this.id+"' class='edit-paste' href='"+this.partEditUrl+"'><i class='icon-pencil'></i></a><a id='edit-delete-"+this.id+"' href='#'><i class='icon-trash'></i></a><span class='part-header-title'> "+this.name+" </span></div><div id='part-properties-"+this.id+"' class='hidden part-properties'></div><div id='part_"+this.id+"' class='layout-element-selected widget' style='height:"+this.heightMM+"px'></div></div></div>";return a},$(".partVisible, .partPageJump, .partIndivisible, .partAutoExtend, .partAutoReduc, .partSortOrder").each(function(a,b){$(b).bind("click",function(){var a=$(this).parents().eq(6).attr("id");splitted=a.split("-");var b=report.getPartById(splitted[1]);$(this).hasClass("partVisible")&&b.setIsVisible(!b.is_visible),$(this).hasClass("partPageJump")&&b.setIsPageJump(!b.is_page_jump),$(this).hasClass("partIndivisible")&&b.setIsIndivisible(!b.is_indivisible),$(this).hasClass("partAutoExtend")&&b.setIsAutoExtend(!b.is_auto_extend),$(this).hasClass("partAutoReduc")&&b.setIsAutoReduc(!b.is_auto_reduc),$(this).hasClass("partSortOrder")&&b.setSortOrder($(this).val()),b.setUpdated(1)})});var Report=function(a,b,c){this.id=a,this.name=b,this.shortName=c,this.width=0,this.partList=[],this.partCount=0,this.currentPartSelected="",this.conversionMmPx=4,this.debug=0};Report.prototype.addPart=function(a){this.partList.push(a),this.partCount++},Report.prototype.getParts=function(){return this.partList},Report.prototype.getPart=function(a){return this.partList[a]},Report.prototype.getPartById=function(a){for(i=0;i<this.partList.length;i++)if(this.partList[i].getPartId()==a)return this.partList[i];return null},Report.prototype.setPartById=function(a,b){for(i=0;i<this.partList.length;i++)this.partList[i].getPartId()==a&&(this.partList[i]=b);return null},Report.prototype.setReportWidth=function(a){this.width=parseInt(a,10)},Report.prototype.getReportWidth=function(){return parseInt(this.width,10)},Report.prototype.getMmPxFactor=function(){return parseInt(this.conversionMmPx,10)},Report.prototype.getId=function(){return this.id},Report.prototype.getName=function(){return this.name},Report.prototype.getShortName=function(){return this.shortName},Report.prototype.getPartCount=function(){return this.partCount},Report.prototype.getCurrentPartSelected=function(){return this.currentPartSelected},Report.prototype.getCurrentPartDivSelected=function(){return"part_"+this.currentPartSelected},Report.prototype.setCurrentPartSelected=function(a){this.currentPartSelected=a};